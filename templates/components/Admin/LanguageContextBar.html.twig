{% import _self as macro %}

<div class="d-flex flex-column justify-content-start">
    <div class="d-flex justify-content-end align-items-center mb-2">
        {%
            for locale in site_context.locales|filter(locale => app.user.canTranslate(locale))
        %}
            {{ dump(showExtendedLanguages == true ? 'true' : 'false') }}
            sldkfjdslf
            {{
                macro.renderLocale(locale, this.entity, this.simpleTranslation)
            }}
        {% endfor %}
    </div>

    {%
        if site_context.extendedContentLocales is not empty and showExtendedLanguages is same as(true)
    %}
        <div class="d-flex justify-content-end align-items-center mb-2">
            {%
                for locale in site_context.extendedContentLocales|filter(locale => app.user.canTranslate(locale))
            %}
                {{
                    macro.renderLocale(locale, this.entity, this.simpleTranslation)
                }}
            {% endfor %}
        </div>
    {% endif %}
</div>

{% macro renderLocale(locale, entity, simpleTranslation) %}
    <a
        href="{{ path('admin_settings_change_language_content_context', {locale: locale}) }}"
        data-turbo-prefetch="false"
    >
        {% set isActive = locale == content_context_language() %}
        {%
            set classes = isActive ? ' bg-outline-primary border-3 border-primary' : 'text-secondary'
        %}

        <twig:Xutim:Admin:Badge class="{{ classes }}">
            {% import '@XutimCore/admin/common/badges.html.twig' as badges %}

            {% if entity is not null %}
                {% set trans = entity.translationByLocale(locale) %}
                {% if trans is null %}
                    {{ badges.missingBadge() }}
                {% else %}
                    {% if simpleTranslation == true %}
                        {{
                            badges.badge('text-bg-green', 'Translated'|trans({}, 'admin'))
                        }}
                    {% else %}
                        {{ badges.publicationStatusBadge(trans) }}
                    {% endif %}
                {% endif %}
            {% endif %}
            {{ locale }}
        </twig:Xutim:Admin:Badge>
    </a>
{% endmacro %}
