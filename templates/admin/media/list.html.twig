{% extends '@XutimCore/admin/base.html.twig' %}

{% block pageTitle %}
    {{ 'media library'|trans({}, 'admin') }}
{% endblock %}

{% block languageBar %}
    <twig:Xutim:Admin:LanguageContextBar
        class="d-flex justify-content-end align-items-center mb-2"
    />
{% endblock %}

{% block breadcrumbHeader %}
    <twig:Xutim:Admin:Breadcrumbs>
        <li class="breadcrumb-item">Media</li>
    </twig:Xutim:Admin:Breadcrumbs>
{% endblock %}

{% block pageMenu %}
    <div class="d-flex align-items-center">
        <div class="me-3 align-items-center">
            <div class="input-icon">
                <form method="GET" action="" data-controller="auto-submit">
                    <input
                        type="text"
                        id="searchTerm"
                        name="searchTerm"
                        autofocus
                        class="form-control"
                        aria-label="{{ 'search'|trans({}, 'admin')|capitalize }}"
                        value="{{ app.request.get('searchTerm') }}"
                        data-action="auto-submit#debouncedSubmit"
                        onfocus="var temp_value=this.value; this.value=''; this.value=temp_value"
                    />
                    <span class="input-icon-addon">
                        <twig:Xutim:Admin:Icon name="search" />
                    </span>
                </form>
            </div>
        </div>
    </div>

    <twig:Xutim:Admin:Button
        tag="a"
        variant="nav"
        data-turbo-frame="modal"
        href="{{ path('admin_media_new') }}"
    >
        <twig:Xutim:Admin:Icon name="photo" class="me-1" />
        {{ 'add new media file'|trans({}, 'admin') }}
    </twig:Xutim:Admin:Button>
{% endblock %}

{% block body %}
    <div
        class="row row-cards row-cols-lg-6 g-3 row-cols-md-4 row-cols-sm-3 row-cols-2"
        id="media-list"
    >
        {% for file in files %}
            {{ include('@XutimCore/admin/media/_row.html.twig') }}
        {% endfor %}
    </div>
    <div class="d-flex justify-content-center mt-4">
        {% set pages = files.NbPages %}
        {% if pages > 1 %}
            {% if files.currentPage-3 > 0 %}
                <span class="text-black p-2 px-3 inline-block rounded-1">
                    ...
                </span>
            {% endif %}
            {% if files.currentPage-2 > 0 %}
                <a
                    href="{{ path('admin_media_list', {searchTerm: app.request.get('searchTerm'), page: files.currentPage-2})}}"
                    class="text-black p-2 px-3 inline-block rounded-1"
                >
                    {{ files.currentPage - 2 }}
                </a>
            {% endif %}
            {% if files.currentPage-1 > 0 %}
                <a
                    href="{{ path('admin_media_list', {searchTerm: app.request.get('searchTerm'), page: files.currentPage-1})}}"
                    class="text-black p-2 px-3 inline-block rounded-1"
                >
                    {{ files.currentPage - 1 }}
                </a>
            {% endif %}
            <a
                href="{{ path('admin_media_list', {searchTerm: app.request.get('searchTerm'), page: files.currentPage})}}"
                disabled="disabled"
                class="bg-gray-200 text-black p-2 px-3 inline-block rounded-1"
            >
                {{ files.currentPage }}
            </a>
            {% if files.currentPage+1 <= pages %}
                <a
                    href="{{ path('admin_media_list', {searchTerm: app.request.get('searchTerm'), page: files.currentPage+1})}}"
                    class="text-black p-2 px-3 inline-block rounded-1"
                >
                    {{ files.currentPage + 1 }}
                </a>
            {% endif %}
            {% if files.currentPage+2 <= pages %}
                <a
                    href="{{ path('admin_media_list', {searchTerm: app.request.get('searchTerm'), page: files.currentPage+2})}}"
                    class="text-black p-2 px-3 inline-block rounded-1"
                >
                    {{ files.currentPage + 2 }}
                </a>
            {% endif %}

            {% if files.currentPage+3 <= pages %}
                <span class="text-black p-2 px-3 inline-block rounded-1">
                    ...
                </span>
            {% endif %}
        {% endif %}
    </div>
{% endblock %}
