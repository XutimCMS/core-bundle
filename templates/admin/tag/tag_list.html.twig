{% extends '@XutimCore/admin/base.html.twig' %}

{% block pageTitle %}{{ 'tags'|trans({}, 'admin')|capitalize }}{% endblock %}

{% block pageMenu %}
    <twig:Xutim:Admin:Button
        tag="a"
        variant="nav"
        href="{{ admin_path('admin_tag_new') }}"
    >
        <twig:Xutim:Admin:Icon name="tag" class="me-1" />
        {{ 'New tag'|trans({}, 'admin') }}
    </twig:Xutim:Admin:Button>
{% endblock %}

{% block languageBar %}
    <twig:Xutim:Admin:LanguageContextBar
        class="d-flex justify-content-end align-items-center mb-2"
        :showExtendedLanguages="false"
    />
{% endblock %}

{% block breadcrumbHeader %}
    <twig:Xutim:Admin:Breadcrumbs>
        <li class="breadcrumb-item">Tags</li>
    </twig:Xutim:Admin:Breadcrumbs>
{% endblock %}

{% block body %}
    {%
        component 'Xutim:Admin:DataTable' with {
            frameId: 'tags-list',
            pager: tags,
            filter: filter,
        }
    %}
    {% block header %}
        {% import '@XutimCore/admin/common/icons.html.twig' as icons %}
        <th
            class="w-1"
            title="{{ 'publication status'|trans({}, 'admin') }}"
            data-controller="tooltip"
        >
            S
        </th>
        <th
            class="w-1"
            title="{{ 'Translated language'|trans({}, 'admin') }}"
            data-controller="tooltip"
        >
            T
        </th>
        <th>
            <a
                class=""
                href="{{ admin_path(app.current_route, {...app.request.query.all(), orderColumn: 'name', orderDirection: filter.reverseDirection('name')}) }}"
            >
                {{ 'name'|trans({}, 'admin') }}
                {{
                    icons.order_arrow('name', filter.orderColumn, filter.orderDirection)
                }}
            </a>
        </th>
        <th>
            {{ 'in news'|trans({}, 'admin')|capitalize }}
        </th>
        <th>
            <a>
                {{ 'updated at'|trans({}, 'admin') }}
                {{
                    icons.order_arrow('updatedAt', filter.orderColumn, filter.orderDirection)
                }}
            </a>
        </th>
    {% endblock %}

    {% block body %}
        {% import '@XutimCore/admin/common/badges.html.twig' as badges %}
        {% for tag in tags %}
            {% set tagColor = tag.color %}
            {%
                set translation = tag.translationByLocaleOrAny(content_context_language())
            %}
            <tr>
                <td>{{ badges.publicationStatusBadgeSimple(tag) }}</td>
                <td class="text-wrap">
                    {%
                        import '@XutimCore/admin/common/translatable.html.twig' as translatable
                    %}
                    {{ translatable.languageBadge(translation, true) }}
                </td>
                <td class="text-wrap">
                    <twig:Xutim:Admin:Button
                        tag="a"
                        variant="link"
                        data-turbo-frame="_top"
                        aria-label="{{ 'show'|trans({}, 'admin') }}"
                        href="{{ admin_path('admin_tag_edit', {id: tag.id}) }}"
                    >
                        <twig:Xutim:Admin:Tag :color="tagColor">
                            {{ translation.name }}
                        </twig:Xutim:Admin:Tag>
                    </twig:Xutim:Admin:Button>
                </td>
                <td>
                    {% if tag.excludeFromNews %}
                        <span class="status status-danger">
                            {{ 'no'|trans({}, 'admin') }}
                        </span>
                    {% else %}
                        <span class="status status-green">
                            {{ 'yes'|trans({}, 'admin') }}
                        </span>
                    {% endif %}
                </td>
                <td>
                    {{ tag.updatedAt|time_ago() }}
                </td>
            </tr>
        {% endfor %}
    {% endblock %}
    {% endcomponent %}
{% endblock %}
